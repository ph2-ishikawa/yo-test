name: PR Workflow

on:
  pull_request:
  workflow_dispatch:
    inputs:
      environment:
        description: 'Environment to deploy to'
        required: true
        type: choice
        options:
        - dev
        - stg
        - prd
        default: 'dev'
jobs:
  build:
    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v3
    - name: Hello world
      run: echo "Hello, GitHub Actions!"

  deploy:
    if: github.event_name == 'workflow_dispatch'
    needs: build
    runs-on: ubuntu-latest
    environment:
            name: ${{ github.event.inputs.environment }}
    steps:
    - name: Check for TEST secret
      run: echo "${{ inputs.environment }}"
    - name: Deploy to ${{ inputs.environment }}
      run: echo "Deploying to environmentï¼š ${{ inputs.environment }}"
    - name: Show TEST secret
      env:
        TEST: ${{ secrets.TEST }}
      run: echo "The value of TEST is $TEST"

  deploy2:
    if: github.event_name == 'workflow_dispatch'
    needs: deploy
    runs-on: ubuntu-latest
    steps:
    - name: Deploy to
      run: echo "Deploying to test"